{% extends "base.html" %}
{% load static %}
{% block content %}
<h2>Global Top Tracks</h2>

<div class="grid">
  {% for t in tracks %}
    <div class="card">
      <h3>{{ t.name }}</h3>
      <p class="meta">{{ t.artist.name }}</p>

      {% if t.apple_preview or t.youtube_url %}            <!-- â˜… changed -->
        <details>
          {% include "_preview_player.html" with track=t %}
        </details>
      {% endif %}
      <div style="display:flex;gap:.5rem;flex-wrap:wrap">
        <a class="btn" href="{% url 'similar' %}?artist={{ t.artist|urlencode }}&track={{ t.name|urlencode }}">
          Similar
        </a>
        <a class="btn btn--secondary" href="{% url 'deepcut' %}?artist={{ t.artist|urlencode }}&track={{ t.name|urlencode }}">
          Deep-cut
        </a>
        <a class="btn" href="{% url 'track_detail' t.artist|urlencode t.name|urlencode %}">
          Detail
        </a>
      </div>
    </div>
  {% endfor %}
</div>
{% endblock %}
